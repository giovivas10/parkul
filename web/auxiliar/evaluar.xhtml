<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <body>

        <ui:composition template="./../layout/layout.xhtml">

            <ui:define name="top">
            </ui:define>

            <ui:define name="content">
                <!-- <p:scrollPanel style="width: auto;height: auto">-->
                <h2>Evaluacion Estado Vehicular</h2>
                <hr />
                <h:form id="frmRegistrarEvaluacion" styleClass="form-horizontal">

                    <p:growl id="mensajeGeneral" showDetail="true" sticky="false"/>

                    <div class="form-group">
                        <div class="col-lg-10" style="text-align: center">
                            <p:imageSwitch effect="zoom" id="photos">
                                <ui:repeat value="#{mbVEvaluacion.propietario.fotoPropietario}" var="photo">
                                    <p:graphicImage value="#{pageContext.contextPath}/resources/images/propietario/#{photo}" cache="false" style="width: auto"/> <!--width="125"-->
                                </ui:repeat>
                            </p:imageSwitch>
                        </div>
                    </div>
                    <div class="form-group">
                        <p:outputLabel value="Fecha" for="txtFechaNacimiento" styleClass="col-lg-2 control-label"/>
                        <div class="col-lg-10">
                            <p:inputText id="txtFechaNacimiento" value="#{mbVEvaluacion.fechaM}" disabled="true" label="Fecha de nacimiento" title="Ejemplo: dd/mm/yyyy" styleClass="tamanioInputText form-control"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <p:outputLabel value="Placa" for="txtPlaca" styleClass="col-lg-2 control-label"/>
                        <div class="col-lg-4">
                            <p:inputText id="txtPlaca" label="Placa" value="#{mbVEvaluacion.propietario.placa}" styleClass="tamanioInputText form-control"/>
                        </div>
                        <div class="col-lg-4">
                            <p:commandButton value="validar" ajax="false" actionListener="#{mbVEvaluacion.validarPlaca()}" update="mensajeGeneral" styleClass="btn btn-default"/>
                            <p:message for="txtPlaca"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <p:outputLabel value="Tipo de vehiculo" for="txtTipoVehiculo" styleClass="col-lg-2 control-label"/>
                        <div class="col-lg-10">
                            <p:inputText id="txtTipoVehiculo" value="#{mbVEvaluacion.tipoVehiculo.vehiculo}" label="Tipo de vehiculo" disabled="true" styleClass="tamanioInputText form-control"/>
                            <p:message for="txtTipoVehiculo"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <p:outputLabel value="Cedula" for="txtCedula" styleClass="col-lg-2 control-label"/>
                        <div class="col-lg-10">
                            <p:inputText id="txtCedula" value="#{mbVEvaluacion.propietario.documento}" label="Cedula" disabled="true" styleClass="tamanioInputText form-control"/>
                            <p:message for="txtCedula"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <p:outputLabel value="Nombres" for="txtNombres" styleClass="col-lg-2 control-label"/>
                        <div class="col-lg-10">
                            <p:inputText id="txtNombres" value="#{mbVEvaluacion.propietario.nombres}" label="Nombres" disabled="true" styleClass="tamanioInputText form-control"/>
                        </div>
                        <p:message for="txtNombres"/>
                    </div>
                    <div class="form-group">
                        <p:outputLabel value="Apellidos" for="txtApellidos" styleClass="col-lg-2 control-label"/> 
                        <div class="col-lg-10">
                            <p:inputText id="txtApellidos" value="#{mbVEvaluacion.propietario.apellidos}" label="Apellidos" disabled="true" styleClass="tamanioInputText form-control"/>
                        </div>
                        <p:message for="txtApellidos"/>
                    </div>
                    <div class="form-group">
                        <p:outputLabel value="Telefono" for="txtTelefono" styleClass="col-lg-2 control-label"/>
                        <div class="col-lg-10">
                            <p:inputText id="txtTelefono" value="#{mbVEvaluacion.propietario.telefono}" label="Telefono" disabled="true" styleClass="tamanioInputText form-control"/>
                            <p:message for="txtTelefono"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <p:outputLabel value="¿El auto posee daños?" for="radioDanios" styleClass="col-lg-2 control-label"/>
                        <div class="col-lg-10">
                            <h:selectOneRadio id="radioDanios" label="Daños" value="#{mbVEvaluacion.evaluacionEstadoVehicular.poseeDanios}">
                                <f:selectItem itemLabel="Si" itemValue="true" />
                                <f:selectItem itemLabel="No" itemValue="false"/>
                                <p:ajax event="valueChange" update="divDaños,mensajeGeneral,divListaDaños" />
                            </h:selectOneRadio>
                        </div>
                    </div>

                    <div class="form-group">
                        <h:panelGroup id="divDaños">
                            <p:outputLabel value="Daño" for="selDanio" rendered="#{mbVEvaluacion.evaluacionEstadoVehicular.poseeDanios}" styleClass="col-lg-2 control-label"/> 
                            <div class="col-lg-10">
                                <h:selectOneMenu id="selDanio" value="#{mbVEvaluacion.parametroEvaluacion.id}" rendered="#{mbVEvaluacion.evaluacionEstadoVehicular.poseeDanios}" styleClass="tamanioSelect form-control">
                                    <f:selectItems value="#{mbRCargarSelects.listaTipoDanio}"/>
                                </h:selectOneMenu>
                            </div>
                            <p:outputLabel value="Parte Vehiculo" for="selParteVehiculo" rendered="#{mbVEvaluacion.evaluacionEstadoVehicular.poseeDanios}" styleClass="col-lg-2 control-label"/> 
                            <div class="col-lg-10">
                                <h:selectOneMenu id="selParteVehiculo" value="#{mbVEvaluacion.parteVehiculo.id}" rendered="#{mbVEvaluacion.evaluacionEstadoVehicular.poseeDanios}" styleClass="tamanioSelect form-control">
                                    <f:selectItems value="#{mbRCargarSelects.listaParteVehiculo}"/>
                                </h:selectOneMenu>
                            </div>
                            <div class="col-lg-offset-2 col-lg-10">
                                <h:commandButton id="modalDialogButton2" value="Foto" onclick="PF('dlg').show();" type="button" rendered="#{mbVEvaluacion.evaluacionEstadoVehicular.poseeDanios}" styleClass="btn btn-primary"/>
                                <h:commandButton value="Agregar" rendered="#{mbVEvaluacion.evaluacionEstadoVehicular.poseeDanios}" actionListener="#{mbVEvaluacion.agregarListaDanios()}" styleClass="btn btn-success"/>
                            </div>
                        </h:panelGroup>
                    </div>

                    <div class="form-group">
                        <h:panelGroup id="divListaDaños">
                            <h:form id="frmListaUsuario" rendered="#{mbVEvaluacion.evaluacionEstadoVehicular.poseeDanios}" styleClass="form-horizontal">                    
                                <p:dataTable id="listaUsuario" var="item" value="#{mbVEvaluacion.listaDaniosVehiculos}" style="font-size: 10px;" scrollable="true" reflow="true">
                                    <f:facet name="header">
                                        Daños
                                    </f:facet>
                                    <p:column headerText="Daño">
                                        <h:outputText value="#{item.parametroEvaluacion.nombre}" />
                                    </p:column>
                                    <p:column headerText="Parte Vehiculo" >
                                        <h:outputText value="#{item.parteVehiculo.nombre}" />
                                    </p:column>
                                    <p:column headerText="Eliminar" width="100">
                                        <p:commandButton value="Eliminar" actionListener="#{mbVEvaluacion.retirarListaDanios(item.parametroEvaluacion,item.parteVehiculo)}" ajax="false"/>
                                    </p:column>
                                </p:dataTable>
                            </h:form>
                        </h:panelGroup>
                    </div>
                    <div class="form-group">
                        <p:outputLabel value="¿El auto posee objetos de valor en su interior?" for="radioObjetos" styleClass="col-lg-2 control-label"/>
                        <div class="col-lg-10">
                            <h:selectOneRadio id="radioObjetos" label="Objetos" value="#{mbVEvaluacion.evaluacionEstadoVehicular.poseeObjetos}">
                                <f:selectItem itemLabel="Si" itemValue="true"/>
                                <f:selectItem itemLabel="No" itemValue="false"/>
                                <p:ajax event="valueChange" update="divObejtos,mensajeGeneral,divListaObjetos" />
                            </h:selectOneRadio>
                        </div>
                    </div> 

                    <div class="form-group">
                        <h:panelGroup id="divObejtos">
                            <p:outputLabel value="Objeto" for="selObjeto" rendered="#{mbVEvaluacion.evaluacionEstadoVehicular.poseeObjetos}" styleClass="col-lg-2 control-label"/> 
                            <div class="col-lg-10">
                                <h:selectOneMenu id="selObjeto" value="#{mbVEvaluacion.objetos.id}" rendered="#{mbVEvaluacion.evaluacionEstadoVehicular.poseeObjetos}" styleClass="tamanioSelect form-control">
                                    <f:selectItems value="#{mbRCargarSelects.listaObjetos}"/>
                                </h:selectOneMenu>
                            </div>
                            <p:outputLabel value="Descrpcion" for="txtDescripcion" rendered="#{mbVEvaluacion.evaluacionEstadoVehicular.poseeObjetos}" styleClass="col-lg-2 control-label"/>
                            <div class="col-lg-10">
                                <p:inputText id="txtDescripcion" value="#{mbVEvaluacion.objetosVehiculos.descripcion}" label="Descripcion" size="35" rendered="#{mbVEvaluacion.evaluacionEstadoVehicular.poseeObjetos}" styleClass="tamanioInputText form-control"/>
                            </div>
                            <div class="col-lg-offset-2 col-lg-10">
                                <h:commandButton id="modalDialogButton" value="Foto" onclick="PF('dlg2').show();" type="button" rendered="#{mbVEvaluacion.evaluacionEstadoVehicular.poseeObjetos}" styleClass="btn btn-primary"/>
                                <h:commandButton value="Agregar" rendered="#{mbVEvaluacion.evaluacionEstadoVehicular.poseeObjetos}" actionListener="#{mbVEvaluacion.agregarListaObjetos()}" styleClass="btn btn-success"/>
                            </div>
                        </h:panelGroup>
                    </div>

                    <div class="form-group">
                        <h:panelGroup id="divListaObjetos">
                            <h:form id="frmListaObjetos" rendered="#{mbVEvaluacion.evaluacionEstadoVehicular.poseeObjetos}" styleClass="form-horizontal">                    
                                <p:dataTable id="listaObjetos" var="item" value="#{mbVEvaluacion.listaObjetosVehiculos}" style="font-size: 10px;" scrollable="true" reflow="true">
                                    <f:facet name="header">
                                        Objetos
                                    </f:facet>
                                    <p:column headerText="Objeto">
                                        <h:outputText value="#{item.objetos.nombre}" />
                                    </p:column>
                                    <p:column headerText="Descripcion" >
                                        <h:outputText value="#{item.descripcion}" />
                                    </p:column>
                                    <p:column headerText="Eliminar" width="100">
                                        <p:commandButton value="Eliminar" actionListener="#{mbVEvaluacion.retirarListaObjetos(item.objetos)}" ajax="false"/>
                                    </p:column>
                                </p:dataTable>
                            </h:form>
                        </h:panelGroup>
                    </div>
                    <div class="form-group">
                        <div class="col-lg-offset-2 col-lg-10">
                            <p:commandButton value="Registrar" ajax="false" actionListener="#{mbVEvaluacion.registrar()}" styleClass="btn btn-default"/>
                        </div>
                    </div>
                    <p:dialog id="modalDialog2" header="TomarFoto" widgetVar="dlg" modal="true" >
                        <h:form enctype="multipart/form-data">
                            <p:outputPanel id="outputPanelStudentUpload2">  
                                <h:panelGrid columns="2">
                                    <p:photoCam widgetVar="pc" listener="#{mbVEvaluacion.oncaptureDanios}" update="outputPanelStudentUpload2"/>
                                    <p:imageSwitch effect="zoom" id="photos2" rendered="#{mbVEvaluacion.bandera1}">
                                        <ui:repeat value="#{mbVEvaluacion.foto}" var="photo">
                                            <p:graphicImage value="#{pageContext.contextPath}/resources/images/evaluar/danios/#{mbVEvaluacion.foto}.png" cache="false" />
                                        </ui:repeat>
                                    </p:imageSwitch>
                                    <p:commandButton type="button" value="Capture" onclick="PF('pc').capture()" ajax="false" update="frmRegistrarEvaluacion"/>
                                    <p:commandButton rendered="#{mbVEvaluacion.bandera1}" type="button" value="Guardar" onclick="PF('dlg').hide();" ajax="false" />
                                </h:panelGrid>
                            </p:outputPanel>
                        </h:form>
                    </p:dialog>
                    <p:dialog id="modalDialog" header="TomarFoto" widgetVar="dlg2" modal="true" >
                        <h:form enctype="multipart/form-data">
                            <p:outputPanel id="outputPanelStudentUpload">  
                                <h:panelGrid columns="2">
                                    <p:photoCam widgetVar="pc2" listener="#{mbVEvaluacion.oncaptureObjetos}" update="outputPanelStudentUpload"/>
                                    <p:imageSwitch effect="zoom" id="photos2" rendered="#{mbVEvaluacion.bandera2}">
                                        <ui:repeat value="#{mbVEvaluacion.foto}" var="photo">
                                            <p:graphicImage value="#{pageContext.contextPath}/resources/images/evaluar/objetos/#{mbVEvaluacion.foto}.png" cache="false" />
                                        </ui:repeat>
                                    </p:imageSwitch>
                                    <p:commandButton type="button" value="Capture" onclick="PF('pc2').capture()" ajax="false" update="frmRegistrarEvaluacion"/>
                                    <p:commandButton rendered="#{mbVEvaluacion.bandera2}" type="button" value="Guardar" onclick="PF('dlg2').hide();" ajax="false" />
                                </h:panelGrid>
                            </p:outputPanel>
                        </h:form>
                    </p:dialog>
                </h:form>
                <!-- </p:scrollPanel>-->
            </ui:define>

            <ui:define name="bottom">
            </ui:define>

        </ui:composition>

    </body>
</html>
